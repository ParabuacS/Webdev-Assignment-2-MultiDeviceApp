<%- include('../partials/header') %>
<!--Please note that I used tailwind on all ejs files-->
<main class="container mx-auto px-6 py-10">
    <header class="py-16 bg-gradient-to-b from-emerald-50 to-white mb-10 -mt-10 border-b border-emerald-100">
        <div class="container mx-auto px-6 text-center">
            <h1 class="text-5xl md:text-6xl font-black text-slate-900 tracking-tight mb-4">
            Creativity <span class="text-emerald-600">starts here.</span>
            </h1>
            <p class="text-lg text-slate-600 max-w-2xl mx-auto leading-relaxed">
            Stories thrive, authors and readers alike can let loose their
            imagination. Create, write, explore, publish.
            </p>
        </div>
    </header>
    <h2 class="text-3xl font-bold text-slate-900 mb-8 tracking-tight">Latest Stories on FreeWrite</h2>
    <div class="grid grid-cols-1 md:grid-cols-3 gap-8">
        <% if (books.length > 0) { %>
            <!--Creating different styles for each genre of book-->
            <!--This was a design choice to distinguish between genres even without reading the story description-->
            <!--Note that I learned this method via ChatGPT and a few tailwind tutorials-->
            <% books.forEach(book => { %>
                <% 
                    let genreBorder = 'border-slate-200';
                    let genreBadge = 'bg-slate-100 text-slate-600';

                    switch(book.genre) {
                        case 'Fantasy':
                            genreBorder = 'group-hover:border-emerald-400';
                            genreBadge = 'bg-emerald-100 text-emerald-700';
                            break;
                        case 'Sci-Fi':
                            genreBorder = 'group-hover:border-blue-400';
                            genreBadge = 'bg-blue-100 text-blue-700';
                            break;
                        case 'Romance':
                            genreBorder = 'group-hover:border-rose-400';
                            genreBadge = 'bg-rose-100 text-rose-700';
                            break;
                        case 'Mystery':
                            genreBorder = 'group-hover:border-amber-400';
                            genreBadge = 'bg-amber-100 text-amber-700';
                            break;
                        case 'Thriller':
                            genreBorder = 'group-hover:border-purple-400';
                            genreBadge = 'bg-purple-100 text-purple-700';
                            break;
                        default:
                            genreBorder = 'group-hover:border-emerald-400';
                            genreBadge = 'bg-emerald-100 text-emerald-700';
                    }
                %>
                <!--these further enhance the visibility of the book cards-->
                <div class="group bg-white rounded-2xl shadow-sm border-2 border-transparent bg-clip-border hover:shadow-xl hover:-translate-y-1 transition-all duration-300 relative overflow-hidden">
                    <div class="absolute inset-0 border border-slate-200 rounded-2xl pointer-events-none transition-colors <%= genreBorder %> border-2"></div>

                    <div class="relative h-64 overflow-hidden">
                        <img src="<%= book.coverImage || 'https://via.placeholder.com/500x750' %>" 
                             class="w-full h-full object-cover group-hover:scale-110 transition-transform duration-700">
                        
                        <div class="absolute top-4 right-4">
                            <span class="<%= genreBadge %> px-3 py-1 rounded-lg text-xs font-black uppercase tracking-widest shadow-sm">
                                <%= book.genre %>
                            </span>
                        </div>
                    </div>
                    
                    <div class="p-6 relative">
                        <h3 class="text-xl font-black text-slate-900 line-clamp-1 group-hover:text-emerald-700 transition-colors">
                            <%= book.title %>
                        </h3>
                        <p class="text-slate-500 text-sm mt-2 line-clamp-2 leading-relaxed h-10">
                            <%= book.description %>
                        </p>
                        
                        <div class="mt-6 pt-4 border-t border-slate-50 flex justify-between items-center">
                            <a href="/book/<%= book._id %>" class="text-emerald-700 font-bold hover:text-emerald-900 transition-colors flex items-center gap-1">
                                Read Story <span class="group-hover:translate-x-1 transition-transform">â†’</span>
                            </a>
                            <span class="text-[10px] text-slate-400 font-bold uppercase tracking-widest">
                                By <%= book.author %>
                            </span>
                        </div>
                    </div>
                </div>
            <% }) %>
        <% } else { %>
            <!--If MongoDB doesn't have any data, this will display on screen instead-->
            <div class="col-span-full text-center py-20 bg-emerald-50/30 rounded-3xl border-2 border-dashed border-emerald-200">
                <p class="text-slate-500 text-lg italic">The library is empty... for now.</p>
                <a href="/write" class="mt-4 inline-block bg-emerald-600 text-white px-8 py-3 rounded-full font-bold hover:bg-emerald-700 transition shadow-lg shadow-emerald-100">
                    Write the first book
                </a>
            </div>
        <% } %>
    </div>
</main>

<%- include('../partials/footer') %>